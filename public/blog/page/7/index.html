
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Naildrivin' &#10106;</title>
  <meta name="author" content="David Bryant Copeland">

  
  <meta name="description" content="Sadly, I was unable to attend RailsConf this year. It was in Baltimore, and it would&#8217;ve been a lot of fun, but it just wasn&#8217;t in the &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.naildrivin5.com/blog/page/7/index.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Naildrivin' &#10106;" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-10518541-5']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <meta name="google-site-verification" content="h_yTpXa6N3ebHj8DYmgX4lIFGHBW1NtGMVHfXuu7i_4" />
</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Naildrivin' &#10106;</a></h1>
  
    <h2>&#10144; Website of David Bryant Copeland</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.naildrivin5.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="http://www.awesomecommandlineapps.com">My Book!</a></li>
  <li><a href="/scalatour">Scala Tour</a></li>
  <li><a href="/talks">Talks</a></li>
  <li><a href="/blog/archives">Blog Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/06/14/in-defense-of-vi.html">In Defense of Vi</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-06-14T00:00:00-07:00" pubdate data-updated="true">Jun 14<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Sadly, I was unable to attend <a href="http://www.railsconf.org">RailsConf</a> this year.  It was in Baltimore, and it would&#8217;ve been a lot of fun, but it just wasn&#8217;t in the cards.  One of the great things about RailsConf is that the videos are posted online very quickly and are always of high quality.  While I always like hearing <a href="http://www.youtube.com/watch?v=b0iKYRKtAsA">DHH</a> speak, I try to never miss one of <a href="http://www.twitter.com/unclebobmartin">Uncle Bob Martin</a>, author of the must-go-read-this-right-now <a href="http://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882/ref=sr_1_1?ie=UTF8&amp;s=books&amp;qid=1276567370&amp;sr=8-1">Clean Code</a>.</p>

<p>This year, he gave an <a href="http://www.youtube.com/watch?v=mslMLp5bQD0">awesome talk</a> on the (lack of) innovation in software development.  He pointed out that we were still writing the same type of code now as we were 40 years ago.  In one part, he asks the crowd what editor they use (knowing full well most will say <a href="http://www.vim.org">vim</a>).  He then proceeds to make light of the audience for using a 19-year-old editor based on a 34-year-old editor.  While his criticism is brief, I think it speaks more to the sorry state of text editing than to the developers (like me) who are &#8220;still&#8221; using vim.</p>

<p>I&#8217;m sure that unclebob is one of the more advanced IDE users, but it just <em>pains</em> me watching my co-workers meander through their code, selecting things with the mouse, and deleting long swaths of text by just hitting the delete key a lot.</p>

<p>While an IDE is great for learning a new environment (especially one as pedantic and verbose as Java or Objective-C), the editing capabilities are counter-intuitive and degenerate.  vim may be hard on the newbie, but it&#8217;s intuitive and logical.  When you understand the &#8220;zen&#8221; of vim, you can fly through your code, playing it like a musical instrument.  It <em>affords</em> muscle memory and allows sophisticated chaining of movement, intent, and action.  You can <em>see</em> what you want to accomplish and your hands make it so, all without reaching for a mouse, cursoring, using the delete key, or contorting your hand with some awful combination of key modifiers.</p>

<p>Think of it as a piano; it&#8217;s a very simple base of simple sounds and actions that, when chained together, can be used to make beautiful music.  An IDE is more like a fancy Casio keyboard with built-in songs and beats.  Shiny, but hollow.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/05/26/is-private-a-code-smell.html">Are Private Methods Code Smells?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-05-26T00:00:00-07:00" pubdate data-updated="true">May 26<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Having had discussions with co-workers on the utility of private methods and <a href="http://scala-programming-language.1934581.n4.nabble.com/Just-curious-why-public-as-default-visibility-td2228941.html">recently on the scala mailing list</a>, there&#8217;s been the notion that private methods (or even protected methods) are code smells &#8211; indicators that there is something wrong with the design of your code.  I believe in many cases they can be, but that private (and protected) methods still have their uses, especially in maintaining a clean design under constraints of getting things done.  First, we need to know what we are talking about.</p>

<h2>Definitions</h2>

<p>While the technical meaning of access modifiers varies with the language, the <em>intent</em> these concepts communicate is what we&#8217;re talking about here.  I assert that the <em>intent</em> of public/protected/private is (and/or should be) as follows:</p>

<ul>
<li><em>public</em> - this method is part of the published API and will not change within major versions of the class</li>
<li><em>protected</em> - this method is a hook for modifying the behavior of this class using subclasses.  It, too, will not change within major versions of the class (of course, it also might exist for code-reuse internal to the class hierarchy).</li>
<li><em>private</em> - this method was <em>refactored out of a well tested public or protected method</em> for reasons of clarity or internal re-use.  This method may absolutely change, even in patch releases, and should not be relied upon to even exist</li>
<li><em>package private</em> (bonus for Java) - this method was written by someone lazy or ingorant, <em>or</em> by someone who acknowledges that this code should be pulled out into its own class, but hasn&#8217;t done so, yet still wants to test it seperately, thus breaking encapsulation.</li>
</ul>


<h2>Why would private methods be code smells?</h2>

<p>The most concise argument is that private methods could indicate that the class that contains them is doing too many things.  Consider this code from shorty, my URL shortener:</p>

<div>
  <pre>
    <code class='scala'>override def contextInitialized(event:ServletContextEvent) = {
  event.getServletContext.log(&quot;Initializing our hasher/DB&quot;)
  val dirName = event.getServletContext.getInitParameter(
    ShortyServlet.DB_DIR_PARAM)
  if (dirName != null) {
    val dir = new File(dirName)
    if (dir.exists()) {
      if (dir.isDirectory()) {
        val hasher = URIHasher(DB(dir))
        hasher.start
        uriHasher = hasher
        event.getServletContext.setAttribute(
          ShortyServlet.URI_HASHER_ATTRIBUTE,uriHasher)
      }
      else {
        throw new ServletException(dir.getAbsolutePath 
          + &quot; is not a directory&quot;)
      }
    }
    else {
      throw new ServletException(dir.getAbsolutePath + &quot; doesn't exist&quot;)
    }
  }
  else {
    throw new ServletException(&quot;You must supply a value for &quot; 
      + ShortyServlet.DB_DIR_PARAM)
  }
}</code>
  </pre>
</div>


<p>Is it totally clear what this method does?  If not, it basically checks that the directory configured for our database exists and is a directory, giving us a specific error message if not.  It&#8217;s a bit long and full of error checking, so the meat where it creates our URI hasher and gives it to the servlet is somewhat obscured.  Here&#8217;s a cleaned up version:</p>

<div>
  <pre>
    <code class='scala'>override def contextInitialized(event:ServletContextEvent) = {
  event.getServletContext.log(&quot;Initializing our hasher/DB&quot;)
  getDBDir(event) match {
    case Right(dir) =&gt; {
      val hasher = URIHasher(DB(dir))
      hasher.start
      uriHasher = hasher
      event.getServletContext.setAttribute(
        ShortyServlet.URI_HASHER_ATTRIBUTE,uriHasher)
    }
    case Left(errorMessage) =&gt; 
      throw new ServletException(errorMessage)
  }
}

private def getDBDir(event:ServletContextEvent) = {
  val dirName = event.getServletContext.getInitParameter(
    ShortyServlet.DB_DIR_PARAM)
  if (dirName != null) {
    val dir = new File(dirName)
    if (dir.exists()) {
      if (dir.isDirectory()) {
        Right(dir)
      }
      else {
        Left(dir.getAbsolutePath + &quot; is not a directory&quot;)
      }
    }
    else {
      Left(dir.getAbsolutePath + &quot; doesn't exist&quot;)
    }
  }
  else {
    Left(&quot;You must supply a value for &quot; + ShortyServlet.DB_DIR_PARAM)
  }
}</code>
  </pre>
</div>


<p>We&#8217;ve added lines of code, but our public method is a lot clearer: we get the dir for our DB; if we get a &#8220;right&#8221;, we have a usable dir, and if we get a &#8220;left&#8221; (the Scala convention for an error), we have the error message to use for our exception.</p>

<p>So, is <code>getDBDir</code> now a code smell?  This is a private method and, this  means that <code>contextInitialized</code> was tested and we extracted the private method as step three of the TDD &#8220;Test/Fix/Refactor&#8221; cycle.</p>

<p>Of course, <code>getDBDir</code> has nothing to do with the <code>ServletContextListener</code> and is really all about checking for a valid path.  So, we should extract it to a new class, right?</p>

<p>Well, if we <em>did</em> do that, we&#8217;ve now actually added a public API to our codebase.  Unless we make the new class completely private to the enclosing class, we&#8217;ve now introduced a new public class that must be tested and managed as part of our system&#8217;s public API.</p>

<p>I don&#8217;t see the benefit to doing that.  I don&#8217;t particularly <em>want</em> this method to be in the public API (at least not <em>now</em>).  So, what about making it a private inner class?  That doesn&#8217;t seem to be much different than what we have now, though it might save a few minutes on a future extraction.</p>

<h2>When IS this a code smell?</h2>

<p>This was a simple example.  Consider a class like <a href="http://github.com/davetron5000/gliffy/blob/master/lib/gliffy/url.rb"><code>SignedUrl</code> in my Gliffy Ruby client</a>.  This class has a fair number of private methods and, overall, is pretty large.  The private methods are vague things like <code>handle_params</code> and <code>get_signing_key</code>.  The private methods aren&#8217;t really the problem, however; They are a symptom of the fact that this class is just doing too many things.  A better design would be to split this class up into something like a <code>UrlParams</code>, <code>UrlSigner</code> and <code>UrlAssembler</code> (just off the top of my head).  The result would be more smaller classes, each with fewer public <em>and</em> private methods.</p>

<h2>What about protected methods?</h2>

<p>In Ruby, you don&#8217;t see a lot of protected methods.  In well-designed Java frameworks (such as <a href="http://www.springframework.org">Spring</a>), you&#8217;ll see them as I&#8217;ve described above: hooks into a helper class that allow you to customize how that class behaves via subclassing.  In non-library code, protected methods tend to get used for code-reuse in narrowly-focused class hierarchies.  For example, the project I&#8217;m working on has a <code>BaseController</code> that provides common methods to the actual web controllers.  Having used protected methods for both of these purposes, I think that, honestly, both <em>can</em> be code smells.</p>

<h3>Protected methods as hooks</h3>

<p>In the case of providing &#8220;hooks&#8221;, I think it&#8217;s clear that by providing them at all, you are acknowledging that your class <em>might</em> be poorly designed (or that your language lacks the expressiveness to better design it).  Consider the venerable (and now deprecated) <a href="http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/web/servlet/mvc/SimpleFormController.html"><code>SimpleFormController</code></a>, a Spring MVC class that provides <em>many</em> protected-method hooks, one of which is <code>protected Map referenceData(HttpServletRequest request)</code>.  This is called during the lifecycle of the controller to get any data needed by the form that should be available to the view (for example, a list of U.S. states from the database).  Your subclass of <code>SimpleFormController</code> overrides this to provide the data as a map.</p>

<p>Why not create an interface called <code>ServletRequestToReferenceData</code> that contains this method, and inject an instance into <code>SimpleFormController</code>?  This would be very Spring-like.  My guess as to why this <em>isn&#8217;t</em> the case is that there is simply too much overhead in making yet another one-method interface and the designer of <code>SimpleFormController</code> just felt this was a reasonable tradeoff.</p>

<p>In Scala, however, this could simply take a function:</p>

<div>
  <pre>
    <code class='scala'>def referenceData[A]((HttpServletRequest) =&gt; Map[String,A]);

  // ...


  controller.referenceData{ request =&gt; 
    // create our map based on the request
  }</code>
  </pre>
</div>


<p>In Ruby, the overhead of creating a new class isn&#8217;t nearly as onerous, and we could still inject a block as we do in Scala.</p>

<p>Ultimately, I would say that you have to make a tradeoff here, and it <em>has</em> to take the language and frameworks into account; a class with many, many hooks might be a code smell, but using it as a means to avoid language ceremony in the name of OO purity is probably a reasonable design tradeoff.</p>

<h3>Protected methods as code sharing</h3>

<p>This use of protected methods is harder to justify, but incredibly handy.  Still, this could be another case of Java (e.g.) not providing the necessary language features to make class extraction more straightforward.  As mentioned, in my current application, I have a <code>BaseController</code>.  It has a helper method as follows:</p>

<div>
  <pre>
    <code class='java'>protected Person getAndValidateLoggedInPerson() {
  Person p = this.personService.getPerson(
    this.authenticationService.loggedInUserId());
  if (p == null) {
    throw new NotFoundException;
  }
  return p;
}</code>
  </pre>
</div>


<p>Because of Spring MVC, we have specialized exceptions for HTTP errors, such as &#8220;NOT_FOUND&#8221;.  Here we contain the logic to identify the id of the logged-in person as well as the check for existence.  Having this available to all controllers in the entire system is very handy.</p>

<p>But, is this a code smell?</p>

<p>We could make a class that does this, turning this code:</p>

<div>
  <pre>
    <code class='java'>Person p = getAndValidateLoggedInPerson();</code>
  </pre>
</div>


<p>into this:</p>

<div>
  <pre>
    <code class='java'>Person p = this.personValidatorAndGetter.getPerson();</code>
  </pre>
</div>


<p>creating a one method class that has many lines of injected dependeicies and other boilerpalte with a few actual lines of code.</p>

<p>I think this is yet another case of pragmatically dealing with language ceremony.  In Scala or Ruby, the overhead of creating re-usable bits of code like this is far lower than for Java; In Scala one could envision a simple function, possibly with some implicit parameters.   Ultimateley, &#8220;too much&#8221; of this sort of thing <em>should</em> be a code smell, but small bits of this, in the name of simplicity, clarity, and simply keeping the codebase smaller isn&#8217;t an automatic red flag.</p>

<h2>Conclusions</h2>

<p>So, are non-public methods code smells?  If we take the <a href="http://en.wikipedia.org/wiki/Code_smell">wikipedia definition</a>, which is clear that a code smell indicates merely the <em>possibility</em> of deeper problems in your code, then, yes, private and protected methods <em>are</em> code smells.</p>

<p>But, should they be avoided at all costs?  Absolutely not.  There&#8217;s many valid reasons to use them, and they do not deserve the blame for an ill-concieved class.  Coding in the real world is about tradeoffs; we have to do the best thing we can with the time, resources, and tools at our disposal.  These tradeoffs may not result in an <a href="http://en.wikipedia.org/wiki/Edmond_Hoyle">According-to-Hoyle</a> OO (or functional) design, but we&#8217;re not writing code to provide examples of programming paradigms or design patterns; we&#8217;re writing it to accomplish something and provide value.  And, as professionals, we need to do it at a predictable rate that doesn&#8217;t incur too much technical debt.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/04/30/my-talk-at-scala-days.html">Video of My Talk at ScalaDays 2010</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-30T00:00:00-07:00" pubdate data-updated="true">Apr 30<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
<a href="http://days2010.scala-lang.org/node/138/169">Video of my talk at ScalaDays is online</a>.  Check it out.  Feedback very much appreciated!
</p>
<p>
<a href="http://days2010.scala-lang.org/node/138/169"><img src="/images/scaladays_talk.jpg" width="400" border="0"/></a>
</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/04/22/scala-days-recap.html">Scala Days Impressions</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-22T00:00:00-07:00" pubdate data-updated="true">Apr 22<span>nd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
I had the good fortune to not only attend <a href="http://days2010.scala-lang.org/">ScalaDays 2010</a>, but also to speak (generously supported by <a href="http://www.opower.com">my employer</a>).  The experience overall was great.
I talked to some really enthusiastic and interesting people (including two high school kids from Austria who were using Lift because, after three years of Java, they were tired of it already!)
</p>
<h1>Overall Impressions</h1>
<ul>
    <li>Scala 2.8 has some <b>really</b> powerful new features; I&#8217;m almost <b>glad</b> I don&#8217;t have a significant codebase
    using 2.7, because I would hate to <b>not</b> be able to use 2.8</li>
    <li>The conference had a wide variety of talks, at varying skill levels; this was not a &#8220;beginners-only&#8221; conference, though
    there were plenty of introductory talks (e.g. the <a href="http://akkasource.org/">Akka</a> talk).</li>
    <li>The Scala team seems very interested in moving Scala into industry and changing the perception of it as an &#8220;academic&#8221;
    language (though I&#8217;m not convinced they know what to do, nor should this be their responsibility).</li>
    <li>Most people I talked to who weren&#8217;t using Scala at their jobs were looking at the strategy <a href="http://sneaking-scala.heroku.com/">I had employed</a>
    (using it for better testing), or were just frustrated with not being able to take advantage of Scala&#8217;s productivity.</li>
    <li>Scala&#8217;s flexible syntax and powerful constructs are being used for a very wide variety of things; there were talks
    on using it for <a href="http://processing.org/">Processing</a>, parallel collections, and cross-compilation to
    non-standard architectures (i.e. chips with no JVM available).</li>
    <li>The term &#8220;monad&#8221; was mentioned during exactly one talk and not at all for the rest of the conference.  This made
    me feel very good, because the impression I get on the Scala mailing list sometimes is that if you don&#8217;t understand
    mathematical type theory, you are a moron who can never understand Scala.  This impression has been proved false.</li>
</ul>
<h2>Talks I Attended</h2>
<p>
It was very interesting to compare this conference to a <a href="http://www.nofluffjuststuff.com/home/main">No Fluff Just Stuff</a> conference.  At those, the speakers
are professional, both in that they are getting paid and that they are just, really, really good at speaking and presenting.  Their talks, however, tend to be introductory and not terribly advanced.  I think that&#8217;s fine, these are the type of speakers you want to have when you need to &#8220;get the message out&#8221; on some new and interesting technologies.
</p>
<p>
The speakers at ScalaDays, however, were just regular people using Scala and wanting to talk about it.  As such, things like presentation style and slides were highly varied in terms of quality.  That being said, even the speakers who had the most trouble, still had some interesting things to talk about.  Following are my quick thoughts on each of the talks I attended:
</p>
<h3>Opening Keynote</h3>
<h4>by Martin Odersky</h4>
<p>
His talk was on the new features of Scala 2.8 which, as I said above, are quite exciting.  Package objects, new collections library, and default/named arguments are just some of the highlights.  All-in-all, some very exciting features.
</p>
<h3>Runing Scala in the Browser</h3>
<h4>by Wolfgang Kuehn</h4>
<p>
He had created a way to write Scala code and turn it into JavaScript, much like how GWT does this with Java.  His approach wasn&#8217;t geared around UI widgets, however, but in creating AJAX applications using WebSockets.  I&#8217;ve always felt JavaScript was assembly language (which is why I think <a href="http://jashkenas.github.com/coffee-script/">coffeescript</a> is so interesting), and this was another way to leverage JavaScript without having to deal with it.
</p>
<h3>Scala Parallel Collections</h3>
<h4>by Aleksander Prokopec</h4>
<p>
This was a preview of a Scala 2.8.1 (or later) feature, where a subpackage of the new 2.8 collections library was created that could perform the collection operations in parallel.  Consider a <tt>filter</tt> on a collection; this is highly parallelizable.  This library is being created to basically implement that in a transparent fashion.  Really interesting stuff.  They had even considered load balancing, via some interesting work-stealing mechanisms.  In only 30 minutes, there wasn&#8217;t a <b>huge</b> amount of detail, but this seems to be another way in which parallel computation could be done very easily.
</p>
<h3>Developing the Scala Bindings to the Fly Object Space</h3>
<h4>by Channing Walton, Nigel Warren, Simon Kent</h4>
<p>
The concept of &#8220;object spaces&#8221; never really sunk in with me, but it wasn&#8217;t actually that relevant to the talk.  This was basically a comparison of a Java library and it&#8217;s straight-port to Scala.  As expected, the Scala implementations were all much more succinct and (to me) clear.  The speakers hadn&#8217;t used a lot of Crazy Scala Magic&#8482; to achieve the real code reduction that was shown.  This talk made it very clear that even if you write &#8220;Java in Scala&#8221;, you still get a lot of productivity gains.
</p>
<h3>CCSTM: Library-based STM for Scala</h3>
<h4>by Nathan Bronson, Hassan Chafi, Kunle Olukotun</h4>
<p>
<a href="http://en.wikipedia.org/wiki/Software_transactional_memory">Software Transactional Memory</a> is one of the go-to features of Clojure.  Clojure supports it natively, while Scala does not.  This talk was on an implementation of STM as a library for Scala.  It seemed relatively simple to use and understand.  While it&#8217;s not as &#8220;clean&#8221; as the Clojure way of doing things, the speaker made a solid case for a library implementation being a better tradeoff, given the difficulty in adding it to the language at this point in Scala&#8217;s life (it&#8217;s easy to forget how mature the Scala language and compiler are, despite how &#8220;new&#8221; it seems).
</p>
<h3>Lightweight language support for type-based, concurrent event processing</h3>
<h4>by Philipp Haller</h4>
<p>
This talk proposed a function type called &#8220;Translucent Functions&#8221; that were better-suited to concurrency than the partial functions used in the actor library.  Honestly, it was a bit over my head, and I wasn&#8217;t able to catch up with the speaker.  Perhaps the paper would be more elucidating for me.
</p>
<h3>Data Parallel Programming in Scala</h3>
<h4>by Bruce Lester</h4>
<p>
This talk was very similar to the one on Scala Parallel Collections.  Here, the speaker had created a collection library separate from the Scala one, designed specifically to allow parallel processing.  He had a very different approach, using control structures to indicate areas where parallelism could occure.  It was pretty interesting, but the Scala 2.8 Collections Library implementation seemed a lot cleaner to me than this.
</p>
<h3>Type Specialization in Scala</h3>
<h4>by Iulian Drago&#x219;</h4>
<p>
One of the new features of 2.8 is the ability to &#8220;specialize&#8221; your code to work with primitive types and avoid boxing/unboxing.  This is something Java cannot really do.  This talk was an overview of how that worked and what specializations were done to the Scala library.  I guess it&#8217;s nice that this kind of optimization if available, but I think it would have negligible gains for most real-world applications that weren&#8217;t doing constant number crunching.  Even in that case, you don&#8217;t necessarily need this.
</p>
<h3>Leaky Monads</h3>
<h4>by Josh Suereth</h4>
<p>
How could I not attend the only session (and mention!) of Monads?  The speaker gave a good overview of using Monads to
implement automatic resource management (e.g. <code>File.open { |file| file.readlines.whatever }</code>).  The idea was that since Monads are designed to hold onto the objects they manage, it&#8217;s a bit inconvienient when dealing with the results of operating on managed resources.  Thus, his monads &#8220;leaked&#8221; their contents to create more concise code.
</p>
<h3>Type-safe SQL embedded in Scala</h3>
<h4>by Christoph Wulf</h4>
<p>
Akin to <a href="http://en.wikipedia.org/wiki/LINQ">LINQ</a>, this talk showed how to write SQL directly inside Scala code, but maintain type safety.  It uses
a compiler plugin to achieve this, and he talked a lot about how to tell the difference between embedded SQL and regular Scala code.  I guess the plugin introspects your database to get the types and generates a bunch of code using some Scala classes that get substituted in during compilation.  Pretty interesting.  I&#8217;m not sure I&#8217;m really <i>missing</i> SQL right in my code, but it is certainly cleaner than JDBC.
</p>
<h3>Scala at LinkedIn: Distribute Computing with Norbert</h3>
<h4>by Chris Conrad</h4>
<p>
This was a talk about how LinkedIn is using Scala to glue together some enabling technologies to create their social network graph.  It seemed really clean and simple, especially since the underlying technologies are all Java-based.  This was mostly an overview of the API and some usage examples.  It&#8217;s <a href="http://sna-projects.com/norbert/">open source</a>, and looks pretty interesting.  I&#8217;m not sure it would be useful for me at my job, but definitely seems like a cool project.
</p>
<h3>Akka</h3>
<h4>by Jonas Boner</h4>
<p>
I was looking forward to this one quite a bit, as akka gets a lot of hype on Twitter.  I think 30 minutes was just too short, as it was pretty light on details.  There was a lot of assertions about Akka that the speakers just didn&#8217;t have time to elucidate or substantiate.  I would love to see a comparison of Scala Actor vs. Akka Actor code and discuss why the Akka way is better.  Similarly, I&#8217;d love to see the basis for all the assertions on Akka&#8217;s performance; it certainly gets a lot of hype.  Jonas is currently working on publicizing the production deployments of Akka (which would go a long way) as well as establishing commercial support for it (which <b>also</b> goes a long way :).
</p>
<h3>Scala IDE for Eclipse</h3>
<h4>by Miles Sabin</h4>
<p>
I went to this purely for my co-workers.  I hate IDEs in general, and Eclipse does some pretty evil things to my co-workers, yet many of them still swear by it.  At any rate, Miles was almost impossible for me to understand (despite being English!) and most of what I got out of the presentation was that Eclipse was very much designed to work with only Java, requiring some nasty hacks to get Scala working with it.  It seems Miles&#8217; Herculean efforts have been used to get around this and there now seems to be a nice development environment for extending and enhancing the Scala plugin.
</p>
<h3>sbt Design and Implementation</h3>
<h4>by Mark Harrah</h4>
<p>
While sbt isn&#8217;t my ideal build tool, but it&#8217;s a billion times better than Maven and Mark&#8217;s talk actually made me appreciate it a lot more.  He is unabashedly in favor of terse symbols over long method names, and he spent some time explaining the rational behind them (thus making things make a bit more sense). His assertion is that you will eventually internalize the symbols and achieve productivity gains at a cost of a slight bump at the start.  I tend to disagree with this, because how often is one modifying their build?  This is why learning and retaining Ant and Maven is so difficult (I can&#8217;t write a <tt>copy</tt> in Ant without a trip to the docs).  At any rate, this was a good talk and great overview of sbt, and, despite me not being into the crazy symbols, I will take it over Maven or Ant any day.  At least it&#8217;s based in a real programming language and not some XML nonsense.
<h3>Processing with Spde</h3>
<h4>by Nathan Hamblen</h4>
<p>
This was a brief over of Processing, for those unfamiliar with this (horribly&#8208;named) visualization tool and then a review of the Scala bindingns the presenter had created.  Interestingly, he created <a href="http://technically.us/spde/About">SPDE</a> as an SBT plugin so that users could gain the benefit of SBT&#8217;s automatic re-compilation and running features.  His plugin + a text editor is a makeshift IDE for Processing, which is pretty cool.  It was very high-level and didn&#8217;t get into too much detail, but the Scala code was, as expected, much more concise than the Java code.
</p>
<h3>Sneaking Scala Into your Organization</h3>
<h4>by Me!</h4>
<p>
I was pretty nervous, as the many of the previous speakers&#8217; topics were all quite heady, but I had practiced my ass off, and delivered the talk as well as I could.  I think it was pretty well received and got some good questions.  I had talked with a few people previously in the conference who were using testing as a way to get Scala into their jobs and a few other people who were interested in what I had to say.  Several people were curious as to how the other developers at OPOWER liked Scala.  I felt pretty good about it.
</p>
<h3>Future of Scala</h3>
<h4>by The Scala Team</h4>
<p>
For this, we broke into small groups and basically unloaded on a poor member of the Scala team as to how anything related to Scala could be better.  Then, the Scala team assembled all of this info while Martin gave a very long term roadmap for Scala.  I do worry that the universe will never catch up to Martin and Scala team as they add more and more advanced and innovative features.
</p>
<p>
After this, a member of the Scala team did a very fast tour of the feedback.  I wish the entire list could be posted; there was a lot of very heartening complaints in there that would not be obvious from the Scala mailing list (e.g.  hate on the underscore, desire to be less academic in terminology)  This fed my (arguably self-biased) impressions that people want to get Scala into industry and that there is a large hole in this part of the Scala universe.
</p>
<p>
There were also some updates on IntelliJ&#8217;s support for Scala.  They sound way ahead of the curve compared to Eclipse and NetBeans, but I was a bit frightened by IDEA&#8217;s  guy saying that they way people learn languages is to ask for auto-completion and see what&#8217;s available.  I see this trend all to often and I think it&#8217;s harmful.  More on that later.
</p>
<h3>Overall</h3>
<p>
Despite still being stuck in Geneva, I&#8217;m glad I went.  Giving my talk was fun, but it was also great to hear about all the many ways in which people are using Scala.  I went in expecting massive academia overload, with a lot of theoretical type system and functional programming talk and got, instead, a wide variety of topics and just the right amount of academia (i.e. not that much).  Really encouraging.  Also encouraging is that ScalaDays 2011 will likely be in the Bay Area, which is a much nicer place to get stuck that stupid Geneva.
</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/03/08/object-oriented-design.html">The Only Four Types of Classes in Your OO System</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-03-08T00:00:00-08:00" pubdate data-updated="true">Mar 8<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
Object-Oriented design is hard, especially in a large application.  It&#8217;s not always clear where logic should go, and there&#8217;s often no &#8220;right place&#8221; to  put a piece of code.  I&#8217;ve found that there are four distinct types of classes that, if you stick to them, can make your code a lot more understandable, and can provide clear direction as to the age-old question of &#8220;where does this code go?&#8221;
</p>
<p>
<h2>0. Background</h2>
The J2EE way is to have model objects be stupid structs, and have all business logic in a service layer (this is actually very close to a classic &#8220;functional programming&#8221; way of doing things; ironic that many Java devs eschew FP).  Spring lets you do whatever you want, but more or less follows this pattern.  
While the &#8220;Rails Way&#8221; is to put business logic on the model objects, I think the &#8220;service layer&#8221; concept <a href="http://www.engineyard.com/blog/2010/let-them-code-cake/">is eventually going to be common practice</a>.
So, I&#8217;ve found that I very rarely make a pure &#8220;by-the-book according-to-Hoyle&#8221; OO-compliant class; I&#8217;ve settled on four patterns that seem to cover pretty much everything.  I&#8217;ve also noticed that when these patterns get mixed together, you get trouble.
</p>
<p>
<h2>1. The Record</h2>
The <i>record</i> is a dumb struct that you usually need to appease your object-relational mapper.  You may need them elsewhere to just name and type some set of data that you either can&#8217;t model as a tuple because of your language, or don&#8217;t want to model as a tuple because of some complexity.  A record typically has methods that merely expose it&#8217;s contents and often need to be mutable for the reasons stated.  You might have derived fields that are convieniences and not based on your core business logic.  An easy example is a person.  They have a name and a birthdate, and you might derive their age from that:
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
</span><span class='line'>  <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</span><span class='line'>  <span class="kd">private</span> <span class="n">Date</span> <span class="n">birthdate</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="nf">Person</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">Date</span> <span class="n">birthdate</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">birthdate</span> <span class="o">=</span> <span class="n">birthdate</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">}</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span> <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span> <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getBirthdate</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">birthdate</span><span class="o">;</span> <span class="o">}</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setBirthdate</span><span class="o">(</span><span class="n">Date</span> <span class="n">birthdate</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">birthdate</span> <span class="o">=</span> <span class="n">birthdate</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getAge</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="c1">// I know this is slightly buggy :)</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">(</span>
</span><span class='line'>      <span class="k">new</span> <span class="nf">Date</span><span class="o">().</span><span class="na">getTime</span><span class="o">()</span>
</span><span class='line'>      <span class="o">-</span> <span class="n">getBirthdate</span><span class="o">().</span><span class="na">getTime</span><span class="o">()</span>
</span><span class='line'>      <span class="o">)</span> <span class="o">/</span> <span class="o">(</span><span class="mi">1000</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">365</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>  <span class="c1">// Maybe some toString, equals, etc. type stuff as well</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>
</p>
<p>
<h2>2. The Immutable Object</h2>
This is the closest to a pure &#8220;object-oriented&#8221; design.  Classes of this type are immutable and should hold data you will use a lot in your system.  They may also probably have some business-logic attached as methods; this business logic should be entirely focused on the object and its contents.  Typical methods will give you more complex information about the data the object contains, or will vend new objects of the same type, based on the method and parameters called.  
</p>
<p>
This is the most clear distinction (in my mind) between functional programming and object-oriented programming.  In an FP world, the data being operated on would be loosely defined (if at all) and you&#8217;d have functions that transform it.  In an OO world, your object&#8217;s data is clearly defined (by the class fields/accessors), and the operations available are the methods of the class.  When you require that the objects of the class be immutable, you have a very nice encapsulated package of data and operations.  This, to me, seems a lot easier to deal with than a &#8220;module&#8221; of functions and some tuples (or lists of tuples) that the functions operate on.  Scala makes it very easy to create classes like this.  It&#8217;s probably one of the few languages that does so (Java certainly is no help, but it <b>can</b> be done).
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Appointment</span> <span class="o">{</span>
</span><span class='line'>  <span class="kd">private</span> <span class="kd">final</span> <span class="n">Date</span> <span class="n">date</span><span class="o">;</span>
</span><span class='line'>  <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">description</span><span class="o">;</span>
</span><span class='line'>  <span class="kd">private</span> <span class="kd">final</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">attendees</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="nf">Appointment</span><span class="o">(</span>
</span><span class='line'>      <span class="n">Date</span> <span class="n">date</span><span class="o">,</span>
</span><span class='line'>      <span class="n">String</span> <span class="n">description</span><span class="o">,</span>
</span><span class='line'>      <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">attendees</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="c1">// normally, you would validate the inputs</span>
</span><span class='line'>    <span class="c1">// for sanity, e.g. Validate.notNull(date)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Since Date is mutable, we make a copy</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">date</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Date</span><span class="o">(</span><span class="n">date</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">;</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">attendees</span> <span class="o">=</span> <span class="n">Collections</span><span class="o">.</span><span class="na">unmodifiableCollection</span><span class="o">(</span><span class="n">attendees</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="n">Date</span> <span class="nf">getDate</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="c1">// Since Date is mutable, we vend a copy</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="nf">Date</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">date</span><span class="o">.</span><span class="na">getTime</span><span class="o">());</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">message</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">People</span><span class="o">&gt;</span> <span class="n">getAttendees</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">attendees</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isLate</span><span class="o">(</span><span class="n">Date</span> <span class="n">otherDate</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">date</span><span class="o">.</span><span class="na">before</span><span class="o">(</span><span class="n">otherDate</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">shouldRemind</span><span class="o">(</span><span class="n">Date</span> <span class="n">otherDate</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="o">!</span><span class="n">isLate</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="n">otherDate</span><span class="o">.</span><span class="na">getTime</span><span class="o">()</span>
</span><span class='line'>      <span class="o">-</span> <span class="k">this</span><span class="o">.</span><span class="na">date</span><span class="o">.</span><span class="na">getTime</span><span class="o">())</span> <span class="o">&gt;=</span> <span class="o">(</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">1000</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isAttending</span><span class="o">(</span><span class="n">Person</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">attendees</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="n">Appointment</span> <span class="nf">reschedule</span><span class="o">(</span><span class="n">Date</span> <span class="n">newDate</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="nf">Appointment</span><span class="o">(</span><span class="n">newDate</span><span class="o">,</span><span class="n">getMessage</span><span class="o">(),</span><span class="n">getAttendees</span><span class="o">());</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="n">Appointment</span> <span class="nf">notAttending</span><span class="o">(</span><span class="n">Person</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="o">(</span><span class="n">isAttending</span><span class="o">(</span><span class="n">p</span><span class="o">))</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">Collection</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">newGroup</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;(</span><span class="n">getAttendees</span><span class="o">());</span>
</span><span class='line'>      <span class="n">newGroup</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">new</span> <span class="nf">Appointment</span><span class="o">(</span><span class="n">getDate</span><span class="o">(),</span><span class="n">getMessage</span><span class="o">(),</span><span class="n">newGroup</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">else</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>
</p>
<p>
The benefits here are huge; immutability allows your codebase to be much more comprehensible, and allows you to use these objects in concurrent situations without worry.  Since they are immutable, their methods are immediate targets for caching if you discover you need to do this to improve performance.
</p>
<p>
<h2>3. The Builder</h2>
While you can certainly use methods (or create methods) on Immutable Object classes to &#8220;build up&#8221; the object you want, this is often cumbersome, and results in a lot of object creation for no real reason.  The &#8220;builder&#8221; can be used to make this a bit simpler.  The Builder is a throwaway class whose sole purpose is to create Immutable Objects.  This obviously creates a very tight coupling between the two classes, but this can be worth it.  This is very preferable to a mutable class and, depending on your operating environment, is preferable to making many intermediate objects you will need to create the Immutable Object.
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppointmentBuilder</span> <span class="o">{</span>
</span><span class='line'>  <span class="kd">private</span> <span class="n">Date</span> <span class="n">date</span><span class="o">;</span>
</span><span class='line'>  <span class="kd">private</span> <span class="n">String</span> <span class="n">description</span><span class="o">;</span>
</span><span class='line'>  <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">people</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="n">AppointmentBuilder</span> <span class="nf">setDate</span><span class="o">(</span><span class="n">Date</span> <span class="n">date</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">date</span> <span class="o">=</span> <span class="n">date</span><span class="o">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="n">AppointmentBuilder</span> <span class="nf">setDescription</span><span class="o">(</span><span class="n">String</span> <span class="n">description</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">description</span> <span class="o">=</span> <span class="n">description</span><span class="o">;</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="n">AppointmentBuilder</span> <span class="nf">addPerson</span><span class="o">(</span><span class="n">Person</span> <span class="n">p</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">this</span><span class="o">.</span><span class="na">people</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">public</span> <span class="n">Appointment</span> <span class="nf">build</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="k">new</span> <span class="nf">Appointment</span><span class="o">(</span><span class="n">date</span><span class="o">,</span><span class="n">description</span><span class="o">,</span><span class="n">people</span><span class="o">);</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>
</p>
<p>
<h2>4. The Service</h2>
The analog of The Record, the <i>service</i> has no data and all logic.  EJBs are services; they have no internal state, operating on their arguments and returning a result.  Methods of services can be very functional in nature (operating solely on structs or immutable objects), or they may provide functionality that implements complex business logic not logically part of an immutable object&#8217;s class.  In a vanilla n-tier application, you use services to get data in and out of your database (you might call these DAOs and you might distinguish different types of services for partitioning, but these are all the same sort of class).
</p>
<p>
Like records, Services are not OO at all; these are the functions to your C programs structs.  But, there is a good reason for this design; you separate concerns, don&#8217;t need to worry about concurrency (services have no state), and can even horizontally partition <i>where</i> serivces actually run.
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Calendaring</span> <span class="o">{</span>
</span><span class='line'>  <span class="cm">/** Schedule an appointment */</span>
</span><span class='line'>  <span class="kd">public</span> <span class="n">Appointment</span> <span class="nf">schedule</span><span class="o">(</span>
</span><span class='line'>      <span class="n">Date</span> <span class="n">date</span><span class="o">,</span>
</span><span class='line'>      <span class="n">String</span> <span class="n">description</span><span class="o">,</span>
</span><span class='line'>      <span class="n">String</span><span class="o">...</span> <span class="n">names</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="n">AppointmentBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AppointmentBuilder</span><span class="o">(</span><span class="n">date</span><span class="o">)</span>
</span><span class='line'>      <span class="o">.</span><span class="na">setDescription</span><span class="o">(</span><span class="n">description</span><span class="o">);</span>
</span><span class='line'>    <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="nl">name:</span> <span class="n">names</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>       <span class="n">Person</span> <span class="n">p</span> <span class="o">=</span> <span class="n">findPersonByName</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
</span><span class='line'>       <span class="k">if</span> <span class="o">(</span><span class="n">p</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>         <span class="n">builder</span><span class="o">.</span><span class="na">addPerson</span><span class="o">(</span><span class="n">p</span><span class="o">);</span>
</span><span class='line'>       <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>
</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/26/reading-a-file-in-scala-ruby-java.html">Reading a File in Scala vs. Java vs Ruby</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-26T00:00:00-08:00" pubdate data-updated="true">Jan 26<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
Examining the code needed to read a file line by line is a a common way to examine the hoops a programming language makes you jump through.  While Perl certainly
has some one-liners for this, let&#8217;s start with Ruby, which presents an elegant and clear way of doing it:
<div>
  <pre>
    <code class='ruby'>File.open(&quot;some_file.txt&quot;) do |file|
  file.readlines.each do |line|
    puts line.upcase
  end
end</code>
  </pre>
</div>

It really doesn&#8217;t get any clearer than that.
</p>
<p>
Here&#8217;s the canonical Java way of doing it, complete with plenty of places to introduce bugs:
<div>
  <pre>
    <code class='java'>import java.io.*;

public class ReadFile {
  public static void main(String args[]) throws IOException {
    File file = new File(&quot;some_file.txt&quot;);
    BufferedReader reader = new BufferedReader(
      new FileReader(file));
    String line = reader.readLine();
    while (line != null) {
      System.out.println(line.toUpperCase());
      line = reader.readLine();
    }
    reader.close();
  }
}</code>
  </pre>
</div>

Yech.  The need to call <code>readLine()</code> twice kinda sucks.  We could use a do-while, but that requires a second <code>line != null</code> check.  Personally, I like to forget the second <code>readLine()</code> and wonder why my code runs forever :)  That being said, this was extremely easy to figure out, even the very first time I did it in 1998.  The class names are obvious, and the documentation is excellent.
</p>
<p>
Scala to the rescue, right?
<div>
  <pre>
    <code class='scala'>import scala.io._

object ReadFile extends Application {
  val s = Source.fromFile(&quot;some_file.txt&quot;)
  s.getLines.foreach( (line) =&gt; {
    println(line.trim.toUpperCase)
  })
}</code>
  </pre>
</div>

This was a slight pain figure out.  I looked in <code>scala.io</code> and, of the few classes that were there (including a curiously named <code>BytePickle</code>), it appeared as though <code>Source</code> was the class to use.  Of course, there&#8217;s no easy way to create one from the constructor, and the scaladoc doesn&#8217;t just say &#8220;Dude, look at the <code>Source</code> object&#8221;.  Once I looked through the <code>Source</code> object&#8217;s scaladoc, the solution presented itself.
</p>
<p>
Of course, unlike every other line-traversing library in the known universe, <code>Source</code> leaves the line endings on.  This is thankfully fixed in 2.8 (by which I mean 2.8 breaks 2.7&#8217;s implementation, which is a strange thing for a point release to do).  The real question is: &#8220;Is this how I&#8217;m supposed to read files in Scala?&#8221;.  With a class called <nobr><code>Source?!</code></nobr>.  The scaladoc says that this class represents &#8220;an iterable representation of source files&#8221;.  That might explain the strange methods like <code>reportError</code> and <code>reportWarning</code>.  I guess this is only for writing the Scala compiler?   If so, <code>scala.io</code> seems an odd place to put this.
</p>
<p>
So, my answer is &#8220;No, this <strong>cannot</strong> be how to canonically read files in Scala&#8221;.  Since the Java way kinda, well, sucks, what alternatives are there?  There&#8217;s <code><a href="http://scalax.scalaforge.org/api/">scalax.io</a></code>, which seems to implement this as a class called, curiously, <code>FileExtras</code>.    I&#8217;m not sure if this code is actively maintained, but it&#8217;s documented in classic Scala style: terse and full of loaded terms like &#8220;nonstrict&#8221;. Nevertheless, there seems to be some code here to easily read a file &#8220;the easy way&#8221; (despite some distracting names).
</p>
<p>
This points out a big difference between &#8220;Scala the language&#8221; and &#8220;Scala the library&#8221;.  Scala the language is very interesting and has a lot of potential.  Scala the library is schizophrenic at best; it&#8217;s not sure if it wants to be OO, functional, or what.  The documentation ranges from sparse to absent, and the overall designs of the classes and package range for sublime to baffling.  Years different from Java 1.1.
</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/24/unicode-domain-names.html">Unicode in Your Domain Names</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-24T00:00:00-08:00" pubdate data-updated="true">Jan 24<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
Got a few questions about how I set up <a href="http://&#10106;&#10144;.ws/">&#10106;&#10144;.ws</a> (which is powered
by <a href="http://www.github.com/davetron5000/shorty">Shorty</a>, my <a href="2009-11-23-good-bad-ugly-scala-url-shortener.html">Scala-based URL shortener</a>), so I thought I&#8217;d write up how I got it working.  Short answer is that it was pretty easy.
</p>
<p>
I got the idea from <a href="http://www.daringfireball.net">John Gruber</a>, who made a similar thing for his site to post entries on <a href="http://www.twitter.com/daringfireball">@daringfireball</a>.  The trickiest part was figuring out what this was called so I could find out who could sell me a domain with unicode characters in it.
</p>
<p>
It turns out, this is called an IDN (short for <a href="http://en.wikipedia.org/wiki/Internationalized_domain_name">Internationalized Domain Name</a>), and not everyone will sell you one.  Couple that with the need to get a non-<code>.com</code> domain, and I had to hunt around for a while.
</p>
<p>
I ended up going with <a href="http://www.dynadot.com/">DynaDot</a> as they could provide the wacky hostname that I wanted as well as a <code>.ws</code> TLD registration.  I was amazed at the number of domain regstrars whose web forms could not handle Unicode.
It&#8217;s been almost 7 years since <a href="http://www.joelonsoftware.com/articles/Unicode.html">Joel Spolsky</a> wrote his screed on dealing with Unicode, so I don&#8217;t know what the deal is.
</p>
<p>
At any rate, the tricky bit in actually <b>using</b> the domain, because a) entering &#10106;&#10144; into vim is nontrivial, and b) I doubt that Apache&#8217;s config file would work with unicode characters in it.  Enter <a href="http://en.wikipedia.org/wiki/Punycode">Punycode</a>, which is an asciification of any IDN.  Fortunately, the domain host provides the Punycode for your IDN, so configuring apache was a matter of:
<div>
  <pre>
    <code class='apache'>&lt;VirtualHost XXXXX&gt;
ServerName xn--dfi5d.ws
ServerAlias www.xn--dfi5d.ws
DocumentRoot /home/webadmin/xn--dfi5d.ws/html
&lt;!-- whatever else goes here --&gt;
JkMount /s* ajp13
JkMount /s ajp13
  &lt;Directory /home/webadmin/xn--dfi5d.ws/html&gt;
    Options Includes FollowSymLinks
    AllowOverride All
  &lt;/Directory&gt;
&lt;/VirtualHost&gt;</code>
  </pre>
</div>

</p>
<p>
At this point, it pretty much worked, although it was sometimes difficult to get curl to work with the non-punyied name.
</p>
<p>
One thing that was weird was that I found that a <b>lot</b> of domains I wanted to try were taken or not available (with no explanation).  Often it seemed like the punycode version was a normal looking URL that was taken; I tried several IDNs that had a unicode character with a wierd &#8220;5&#8221;, and they punyied to an ascii 5.  Not sure what the deal is there, but I eventually found the one I wanted.
</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/09/Top-5-Omissions-From-Spring-MVC.html">Top 5 Shocking Omissions From Spring MVC</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-09T00:00:00-08:00" pubdate data-updated="true">Jan 9<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
Been working with Spring MVC recently.  My enthusiasm has waned somewhat, as I&#8217;ve discovered that for all of it&#8217;s tweakability and configurableosity, it omits what I believe to be incredibly obvious things:
<ol>
  <li><strong>Simple, 80/20 conventions by default</strong> - While the phrase &#8220;convention over configuration&#8221; appears numerous times
  in the Spring documentation, it is <strong>still</strong> unable to call the <code>foo</code> method of the class
  <code>BarController</code> when I request the url <code>bar/foo</code> without a lot of configuration, some of which subtly conflicts
  and causes silent failures.   The default configuration is useless</li>
  <li><strong>Debugging the Routing</strong> - I shovel angle bracket after annotation after angle bracket into Spring and it simply <strong>can not</strong> tell me what
  URL patterns are mapped to where, and why a given URL isn&#8217;t mapped, nor what to do to get it mapped. It&#8217;s <strong>whole purpose is to map URLs to controllers</strong>.
  Shocking.</li>
  <li><strong>Simple internal routing without magic strings</strong> - If I&#8217;ve mapped <code>FooController</code>&#8217;s <code>bar</code>
  method, shouldn&#8217;t I be able to redirect/route to that in code via <code>route(FooController.class,"bar")</code>, regardless of the specific URL that
  <code>FooController</code> and <code>bar</code> respond to?  Instead, I&#8217;ve got magic strings everywhere and if my urls ever change, god help me.  And don&#8217;t get me 
  started about accessing this stuff via tests.</li>
  <li><strong>Simple web-testing</strong> - Adding a dependency on JWebUnit doesn&#8217;t cut it.  Jetty and Tomcat cannot hot deploy.  How do people test these things??!?!</li>
  <li><strong>Test Fixture Support</strong> - I had to hack this up with DBUnit.  With maven in the mix, it&#8217;s a huge hit to productivity, but at least I have it.  What project <strong>doesn&#8217;t</strong> need this??!?!</li>
</ol>
</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/11/24/scalas-map-literal-as-a-prezi.html">Prezi on Decoding the Scala Map Literal</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-24T00:00:00-08:00" pubdate data-updated="true">Nov 24<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p class="first">
If you haven&#8217;t checked out <a href="http://www.prezi.com">Prezi</a> as a means to create presentations, you really should.  They have rethought the entire
user experience, and it&#8217;s totally awesome.  To give you a flavor of it, I created a presentation of
my blog on <a href="/blog/2009/11/12/deconstructing-scala-map-literal.html">Deconstructing Scala&#8217;s Map Literal</a>.  I can&#8217;t create audio in the format
Prezi requires, so there&#8217;s no voice over, but I think it still works.
</p>
<p>
<object id="prezi_pj5_r8volng6" name="prezi_pj5_r8volng6" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="550" height="400"> <param name="movie" value="http://prezi.com/bin/preziloader.swf"/>  <param name="allowfullscreen" value="true"/>  <param name="allowscriptaccess" value="always"/>  <param name="bgcolor" value="#ffffff"/>  <param name="flashvars" value="prezi_id=pj5_r8volng6&amp;lock_to_path=1&amp;color=ffffff&amp;autoplay=no"/>  <embed id="preziEmbed_pj5_r8volng6" name="preziEmbed_pj5_r8volng6" src="http://prezi.com/bin/preziloader.swf" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="550" height="400" bgcolor="#ffffff" flashvars="prezi_id=pj5_r8volng6&amp;lock_to_path=1&amp;color=ffffff&amp;autoplay=no"> </embed> </object>
</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/11/23/good-bad-ugly-scala-url-shortener.html">Writing a URL Shortener in Scala - the Good, the Bad, the Ugly</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-23T00:00:00-08:00" pubdate data-updated="true">Nov 23<span>rd</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p class="first">
I finally got around to finishing <a href="http://www.github.com/davetron5000/shorty">Shorty</a>, my url-shortener for my vanity short-domain, 
<a href="http://&#10106;&#10144;.ws/">&#10106;&#10144;.ws</a>.  I did the whole thing in Scala as a way to create a fully-functining application
that I would use and that I could finish in my non-work time.  Scala unequivocally made this task enjoyable and quick.  J2EE, on the other hand, 
did not help one bit.
</p>
<p>
<h2>The Good</h2>
<h3>Scala</h3>
</p>
<p>
My Scala code is so much shorter and easier to follow than the Java equivalent.  Consider this code that, given
the request path, finds a controller to handle it, and then calls the appropriate method based upon
the HTTP method:
<div>
  <pre>
    <code class='scala'>route(path) match {
  case Some(controller) =&gt; {
    val result = determineMethod(request) match {
      case GET =&gt; controller.get(params(request))
      case PUT =&gt; controller.put(params(request))
      case POST =&gt; controller.post(params(request))
      case DELETE =&gt; controller.delete(params(request))
    }</code>
  </pre>
</div>

It&#8217;s highly readable, and very concise; the Java version would&#8217;ve required a lot more variables, some noisier control structures, and a lot more braces and parens.
</p>
<p>
<h3>ScalaTest</h3>
</p>
<p>
ScalaTest resulted in a lot more readable code than JUnit or TestNG would&#8217;ve.  Because of Scala&#8217;s syntax, the tests are also free of weird dots and &#8220;literate&#8221; syntax that
isn&#8217;t quite that literate.
<div>
  <pre>
    <code class='scala'>it (&quot;should respond to get for a URL that is known&quot;) {
  val controller = new OneUrlController(hasher,&quot;738ddf&quot;)
  val result = controller.get(Map())
  result.getClass should equal (classOf[URL])
  result.asInstanceOf[URL].url should equal 
    (&quot;http://www.google.com&quot;)
}</code>
  </pre>
</div>

The delineation between &#8220;expected&#8221; and &#8220;received&#8221; could not be more clear.  <tt>assertEquals</tt> just isn&#8217;t the same.
The latest version of ScalaTest has some <a href="http://www.scalatest.org/getting_started_with_flat_spec">BDD options</a> that look really great.
</p>
<p>
<h2>The Bad</h2>
<h3>SBT</h3>
</p>
<p>
I really wanted to like <a href="http://code.google.com/p/simple-build-tool/">SBT</a>, and, while it&#8217;s a billion times better than 
<a href="/blog/2009/05/13/why-maven-drives-me-absolutely-batty.html">maven</a>, it&#8217;s still not as easy to use as I&#8217;d like it to be.
</p>
<p>
I like:
<ul>
    <li>Building code and downloading dependencies are separate</li>
    <li>The save/run-tests loop is very handy</li>
    <li>JavaRebel + re-deploying the webapp on file save is very handy</li>
</ul>
However:
<ul>
    <li>The test output is horrid; big huge stack traces</li>
    <li><b>Constant</b> <tt>OutOfMemory</tt> errors that <b>it traps</b> and then <b>doesn&#8217;t exit</b>.  I had to <tt>kill -9</tt> SBT <b>a lot</b></li>
    <li>Still more complicated than shell scripts</li>
</ul>
I believe that a build tool should be a DSL for automating software development tasks, which means it should be more concise and easier to use than UNIX shell scripts.  Ant, Maven, and SBT
fail miserably at this.
</p>
<p>While SBT is light-years ahead by using an actual programming language, I found it very difficult to customize.  Part of this is that the scaladoc tool gives developers <b>no help</b> in documenting their API, but, when it comes down to it, Scala and Java are not system automation languages.
</p>
<h3>scaladoc</h3>
<p>
Scaladoc is nowhere near as powerful as Javadoc.  It makes it very hard to document how to use your code.   Scala should have a <b>more</b> advanced documentation system than Java, but it actually has a much more primitive one; even RDoc is better.  Hopefully, as Scala&#8217;s popularity increases, the tools surrounding it will improve.
</p>
<p>
<h2>The Ugly</h2>
<h3>J2EE Deployment</h3>
</p>
<p>
Deployment is an underappreciated aspect of why Rails is so easy to use; copy/push your code to the production server, tell it you are running in production, and go.  With J2EE, you get NONE of this. 
</p>
<p>
If you want to alter configuration based upon environment, you are entirely on your own.  J2EE, Ant, Maven, and SBT give you no real help or support; you have to roll it yourself.  I&#8217;m just shocked at this omission; J2EE is <b>ten years old</b> and <b>still</b> has not provided a solution for something that <b>every</b> project needs.  Amazing.
</p>
<p>
<h3>Servlet Spec</h3>
</p>
<p>
Java 5 is at end of life.  The latest released Servlet Spec <b>still doesn&#8217;t support generics</b> and is <b>still</b> completely schizophrenic about it&#8217;s API (some methods use <tt>Enumeration</tt>, some use arrays, some use <tt>Iterable</tt>.  Ugh).  
</p>
<p>The 3.0 spec looks slightly more sane, but it really doesn&#8217;t do us any favors.  <tt>web.xml</tt> is a trainwreck of stupidity, there&#8217;s zero support for conventions, and the whole thing just feels like a solution designed for a problem that few of us ever have.
</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/8/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/6/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>
  <img class="left" src="http://www.gravatar.com/avatar/ae52d95bbc43d0a62044a9a6b5674de0.png">
  I&#8217;m a programmer, musician, and <a href="http://www.awesomecommandlineapps.com">author</a>.  I speak frequently at national and regional conferences and spend my days currently as a lead engineer at <a href="http://www.stitchfix.com">Stitch Fix</a>. I&#8217;ve written applications in C, C++, Perl, Ruby, Scala, and many others, on large and small teams. As a developer, I believe in clean code, making it right, providing a great user experience and using the right tool for the job.  As a bass player, I believe in using a pick, locking it down, and ripping off Peter Hook.  As an author, I insist on the Oxford Comma, try to avoid semi-colons, and dislike title case.
  </p>
</section>
<section>
  <p>
  <a href="http://pragprog.com/book/dccar/build-awesome-command-line-applications-in-ruby"><img class="center" src="http://imagery.pragprog.com/products/249/dccar_xlargebeta.jpg?1319573406"></a>
  </p>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/davetron5000">@davetron5000</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'davetron5000',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("davetron5000", 5, true);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/davetron5000" class="twitter-follow-button" data-show-count="false">Follow @davetron5000</a>
  
</section>

<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/02/28/is-your-dsl-really-a-type-system.html">Is Your DSL Really a Type System?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/19/stitch-fix-slash.html">Stitch Fix!</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/30/what-i-mean-by-calling-out-bad-code.html">What I mean by &#8216;calling out&#8217; bad code</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/27/what-i-learned-working-at-livingsocial.html">&#10106;&#10144; What I learned working at LivingSocial</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/24/if-you-call-out-bad-code.html">If you call out bad code, make sure it&#8217;s bad first</a>
      </li>
    
  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - David Bryant Copeland -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
